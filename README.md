# The Historical Court (Multi-Agent System)

**The Historical Court** ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö Multi-Agent ‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏î‡πâ‡∏ß‡∏¢ **Google ADK (Agent Development Kit)** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏ï‡πà‡∏™‡∏ß‡∏ô‡∏ó‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡πÇ‡∏î‡∏¢‡∏°‡∏µ AI 3 ‡∏ï‡∏±‡∏ß‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÇ‡∏ï‡πâ‡πÅ‡∏¢‡πâ‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

## System Architecture (‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö)

‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏° Workflow ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

### Step 1: The Inquiry (Sequential)
- **Root Agent (The Judge)** ‡∏£‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ (Topic) ‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° State ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÑ‡∏ï‡πà‡∏™‡∏ß‡∏ô

### Step 2: The Investigation (Parallel Simulation)
‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ Sub-agents ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô Shared State:
- **Agent A (The Admirer):** ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Wikipedia ‡πÇ‡∏î‡∏¢‡πÄ‡∏ô‡πâ‡∏ô **"‡∏Ç‡πâ‡∏≠‡∏î‡∏µ/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"** (Positive Bias)
- **Agent B (The Critic):** ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Wikipedia ‡πÇ‡∏î‡∏¢‡πÄ‡∏ô‡πâ‡∏ô **"‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢/‡∏Ç‡πâ‡∏≠‡πÇ‡∏ï‡πâ‡πÅ‡∏¢‡πâ‡∏á"** (Negative Bias)

### Step 3: The Trial & Review (Loop Logic)
- **The Judge** ‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô State (`pos_data` ‡πÅ‡∏•‡∏∞ `neg_data`)
- **Loop Decision:**
  - ‡∏´‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡∏°‡∏î‡∏∏‡∏• (Unbalanced) Judge ‡∏à‡∏∞‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ Sub-agents ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î
  - ‡∏´‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß Judge ‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô (Verdict)

### Step 4: The Verdict (Output)
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ Tool `deliver_verdict` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå `.txt` ‡πÅ‡∏•‡∏∞‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Exit Loop)

---

## Technical Implementation

### State Management
‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ **Session State** ‡∏Ç‡∏≠‡∏á ADK ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Agent:
- `topic`: ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡πÑ‡∏ï‡πà‡∏™‡∏ß‡∏ô
- `pos_data`: List ‡∏Ç‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏ù‡∏±‡πà‡∏á‡∏ö‡∏ß‡∏Å
- `neg_data`: List ‡∏Ç‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏ù‡∏±‡πà‡∏á‡∏•‡∏ö

### Tools
1. **`search_wikipedia(query)`**: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏à‡∏£‡∏¥‡∏á
2. **`save_evidence_to_state(content, type)`**: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Memory ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö
3. **`deliver_verdict(final_verdict)`**: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏ö Session

---

## Project Structure
‚îú‚îÄ‚îÄ agent.py           # Logic ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á Agents ‡πÅ‡∏•‡∏∞ Tools
‚îú‚îÄ‚îÄ main.py            # Entry point ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
‚îú‚îÄ‚îÄ README.md          # ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå
‚îî‚îÄ‚îÄ verdicts/          # Folder ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (.txt)

---

### üìÑ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: The Verdict Output (.txt Implementation)

‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå `agent.py` ‡∏ï‡∏£‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Tool ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠ `deliver_verdict` (‡∏´‡∏£‡∏∑‡∏≠ `exit_loop`) ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ú‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î Format ‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° ‡∏°‡∏µ Header/Footer ‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö

**‡∏ô‡∏≥‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà tool `deliver_verdict` ‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô `agent.py`:**

import os
from datetime import datetime
from google.adk.tools.tool_context import ToolContext

def deliver_verdict(
    tool_context: ToolContext,
    final_verdict: str
) -> dict[str, str]:
    """
    Saves the final verdict to a formatted .txt file and signals the end of the trial.
    
    Args:
        final_verdict (str): The comprehensive summary text generated by The Judge agent.
        
    Returns:
        dict: A status message indicating the file location.
    """
    # 1. ‡∏î‡∏∂‡∏á Topic ‡∏à‡∏≤‡∏Å State (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠ Default)
    topic = tool_context.state.get("topic", "Unknown_Case")
    
    # 2. ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô _ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Error)
    safe_topic = topic.replace(" ", "_")
    filename = f"Verdict_{safe_topic}.txt"
    
    # 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå (Formatting)
    timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    divider = "=" * 60
    
    file_content = f"""{divider}
THE HISTORICAL COURT: OFFICIAL VERDICT
{divider}
CASE TOPIC : {topic}
DATE       : {timestamp}
JUDGE      : AI System (Google ADK)
{divider}

{final_verdict}

{divider}
*** End of Report ***
*** Generated by Multi-Agent System ***
"""

    # 4. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå (‡πÉ‡∏ä‡πâ encoding='utf-8' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)
    try:
        # ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ folder verdicts ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á
        # output_dir = "verdicts"
        # if not os.path.exists(output_dir):
        #     os.makedirs(output_dir)
        # filepath = os.path.join(output_dir, filename) 
        
        # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå (‡πÄ‡∏≠‡∏≤‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà root ‡∏Å‡πà‡∏≠‡∏ô)
        with open(filename, "w", encoding="utf-8") as f:
            f.write(file_content)
            
        print(f"\n[SYSTEM] Verdict saved successfully at: {filename}")
        
        return {
            "status": "success", 
            "message": f"Verdict saved to {filename}. The trial is adjourned.",
            "file_path": filename
        }
        
    except Exception as e:
        error_msg = f"Error saving verdict file: {str(e)}"
        print(f"[SYSTEM] {error_msg}")
        return {"status": "error", "message": error_msg}
